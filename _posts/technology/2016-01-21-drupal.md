---
layout: post
title:  "在 CentOS 7 下试验 Drupal 7"
categories: technology
---
按顺序安装好Apache、MariaDB和PHP，启动Apache和MariaDB，创建一个UTF-8字符集的数据库。

    > create database if not exists drupal default character set utf8;

在Drupal官网下载Drupal core文件：`drupal-7.36.tar.gz`

    $ tar xzvf drupal-7.36.tar.gz
    $ cd drupal-7.36

拷贝所有文件到web目录，包括2个隐藏文件。

    # cp -R * .gitignore .htaccess /var/www/html

创建settings.php文件

    # cp /var/www/html/sites/default/default.settings.php /var/www/html/sites/default/settings.php

改变web目录下所有文件的所有者和所属组群

    # chown -R apache:apache /var/www/html/* /var/www/html/.gitignore /var/www/html/.htaccess

防止SELinux捣乱

    # chcon -R -t httpd_sys_content_rw_t /var/www/html/sites/default/ /var/www/html/sites/all/modules/ /var/www/html/sites/all/themes/

浏览http://localhost开始安装。

使drupal的`.htaccess`文件起作用

    <Directory "/var/www/html">
        AllowOverride All
    </Directory>

启用发送邮件支持

1. 安装`SMTP Authentication Support` module。
2. # setsebool -P httpd_can_sendmail 1

启用中文环境

1. 安装`Localization update` module。
2. 开启`Locale` module（`Localization update` module依赖`Locale` module）。
3. Configuration -> Languages -> Add language。

安装常用modules

1. 安装`Administration menu` module，之后disable`Toolbar` module。
2. 安装`Back To Top` module。
3. 安装`Backup and Migrate` module。
4. 安装`Theme developer` module。

安装CKEditor

1. 安装`Wysiwyg` module，`Wysiwyg`原生支持`CKEditor`。
2. 下载`CKEditor`，*注意*版本有限制，3.6.6版本OK，放到`/var/www/html/sites/all/libraries/ckeditor`中。

安装UEditor

1. 安装`Ueditor for wysiwyg` module。
2. 安装`Wysiwyg` module（`Ueditor for wysiwyg` module依赖`Wysiwyg` module）。
3. 安装`Libraries API` module(`Ueditor for wysiwyg` module依赖`Libraries API` module)。
4. 下载PHP版本的`UEditor`，放到`/var/www/html/sites/all/libraries/ueditor`中。
5. 打开`/var/www/html/sites/all/libraries/ueditor/ueditor.all.js`，删除以下代码。

        if(holder.id){
          newDiv.id = holder.id;
          domUtils.removeAttributes(holder,'id');
        }

安装Views

1. 安装`Views` module。
2. 安装`Chaos tool suite (ctools)` module（`Views` module依赖`Chaos tool suite (ctools)` module）。

安装Firefox add-ons

1. 安装`Web Developer`。
2. 安装`Firebug`。